<!DOCTYPE html><html>
<head>
    <style>
    #myCanvas {
        
        border: 10px solid black;
    }
    .rectangle {
        border: 1px solid #FF0000;
        position: absolute;
    }
    </style>
    <script src="ocrad.js"></script>
    <script src='https://cdn.rawgit.com/naptha/tesseract.js/1.0.10/dist/tesseract.js'></script>
    <script>
        
        var imageDatas = [];
        function init() {
            var canvas = document.getElementById('myCanvas');
            var context = canvas.getContext('2d');
            var canvasHolder = document.getElementById("canvasHolder");
            

            var img = document.getElementById('picture');
            Tesseract.recognize(img)
                .progress(function  (p) { 
                    //console.log('progress', p)    
                })
                .then(function (result) { 
                 
                    result.words.forEach(function (w) {
                        console.log(w.text);
                    });
                    
                    //console.log(result);
                })
            
            function drawScreen() {
                
                canvas.width = img.width;
                canvas.height = img.height;
                context.drawImage(img, 0, 0 );
                
                console.log(imageDatas.length);
                if (imageDatas.length > 0) {
                    var str = OCRAD(imageDatas[0]);
                    console.log(str);
                    requestAnimationFrame(drawScreen);
                }
            }
            drawScreen();
            
            var mouse = {
                x: 0,
                y: 0,
                startX: 0,
                startY: 0
            };

            function setMousePosition(e) {
                var ev = e || window.event; //Moz || IE
                if (ev.pageX) { //Moz
                    mouse.x = ev.pageX + window.pageXOffset;
                    mouse.y = ev.pageY + window.pageYOffset;
                } else if (ev.clientX) { //IE
                    mouse.x = ev.clientX + document.body.scrollLeft;
                    mouse.y = ev.clientY + document.body.scrollTop;
                }
            };



                var element = null;

            canvasHolder.onmousemove = function (e) {
                setMousePosition(e);
                if (element !== null) {
                    element.style.width = Math.abs(mouse.x - mouse.startX) + 'px';
                    element.style.height = Math.abs(mouse.y - mouse.startY) + 'px';
                    element.style.left = (mouse.x - mouse.startX < 0) ? mouse.x + 'px' : mouse.startX + 'px';
                    element.style.top = (mouse.y - mouse.startY < 0) ? mouse.y + 'px' : mouse.startY + 'px';
                }
            }

            canvasHolder.onclick = function (e) {
                if (element !== null) {
                    element = null;
                    canvasHolder.style.cursor = "default";
                   // var imageDAta = context.getImageData(0, 0, canvas.width, canvas.height);
                   // var str = OCRAD(imageDAta); console.log(str);
                  //  console.log("finsihed.");
                } else {
                    //console.log("begun.");
                    mouse.startX = mouse.x;
                    mouse.startY = mouse.y;
                    element = document.createElement('div');
                    element.className = 'rectangle'
                    element.style.left = mouse.x + 'px';
                    element.style.top = mouse.y + 'px';
                    canvasHolder.appendChild(element);
                    canvasHolder.style.cursor = "crosshair";
                    
                }
            }
        }
        
        </script>
    </head>
<body onload="init()">
    <div id="canvasHolder">
        <canvas id="myCanvas"  ></canvas></div>
    
        <img src="numbersTestText.png" id="picture">
    
    <!--<button onclick="init()" width="100px" height="100px"></button>
    <input type="file" accept=".jpg, .png, .jpeg, .gif, .bmp, .tif, .tiff|images/*">
    <img src="numbersTestText.png" id="myimg">-->
    </body>
    
    
</html>